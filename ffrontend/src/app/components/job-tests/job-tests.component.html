<nav class="navbar">
  <app-navbar [title]="'Complete Tests'"></app-navbar>
</nav>

<div class="tests-container">
  <div class="test-content">
    <div class="current-test" *ngIf="currentTest">
      <div class="test-header">
        <h2>{{currentTest.name}}</h2>

        <div class="test-info">
          <span class="time-limit">Time limit: {{currentTest.duration}} minutes</span>
          <span class="test-type">Type: {{currentTest.type}}</span>
        </div>
      </div>

      <div class="test-description">
        {{currentTest.description}}
      </div>

      <div [ngSwitch]="currentTest.type">
        <div *ngSwitchCase="'programming'">
          <app-programming-test 
            [description]="currentTest.description || ''"
            [template]="currentTest.template || ''"
            [testCases]="currentTest.testCases || []"
            (answerChange)="onAnswerChange($event)">
          </app-programming-test>
        </div>

        <div *ngSwitchDefault class="test-content-generic">
          This test type is not yet supported.
        </div>
      </div>

      <div class="test-actions">
        <button class="save-button" [disabled]="isSaving">
          {{isSaving ? 'Saving...' : 'Save Progress'}}
        </button>

        <div class="navigation-buttons">
          <button class="submit-button" (click)="completeTest(currentTest.id)">
            Submit Test
          </button>

          <button class="next-button" *ngIf="!isLastTest" [disabled]="!canNavigateNext" (click)="onNext()">
            Next Test
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="test-sidebar">
    <h3>Test Progress</h3>
    <div class="test-list">
      <div class="test-item" 
           *ngFor="let test of tests; let i = index"
           [class.active]="test.id === currentTest?.id"
           [class.completed]="getTestState(test.id)?.isCompleted"
           [class.disabled]="!canAccessTest(i)"
           (click)="canAccessTest(i) && setCurrentTest(i)">
        <span class="test-name">{{test.name}}</span>
        <span class="test-status" [class.completed]="getTestState(test.id)?.isCompleted">
          {{getTestState(test.id)?.isCompleted ? '✓' : '•'}}
        </span>
      </div>
    </div>

    <button class="finish-button" (click)="onFinish()">
      Complete All Tests
    </button>
  </div>
</div>